SELECT FLAVOR
FROM FIRST_HALF as f
WHERE f.TOTAL_ORDER >= 3000 
    AND f.FLAVOR IN (SELECT i.FLAVOR FROM ICECREAM_INFO as i WHERE i.INGREDIENT_TYPE = 'fruit_based')
ORDER BY f.TOTAL_ORDER DESC;